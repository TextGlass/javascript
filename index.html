<html>
<head>
  <title>TextGlass</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style type="text/css">
    body {
      font-family: Helvetica, Arial, sans-serif;
    }
    .out {
      color: #0000FF;
      font-family: "Courier New", Courier, monospace;
      padding-left: 20px;
    }
    .input {
      width: 100%;
      max-width: 500px;
    }
  </style>
</head>
<body onload="main()">

  <h1>TextGlass Javascript Client</h1>

  Pattern file: <input id="pattern" class="input" type="text" size="60" value="http://www.rezsoft.org/textglass/reference/domains/a/patterns.json"><br>
  <br>
  Attribute file: <input id="attribute" class="input"  type="text" size="60" value="http://www.rezsoft.org/textglass/reference/domains/a/attributes.json"><br>
  <br>
  Pattern Patch file: <input id="patternpatch" class="input" type="text" size="60" value=""><br>
  <br>
  Attribute Patch file: <input id="attributepatch" class="input" type="text" size="60" value=""><br>
  <br>
  <div id="clientout" class="out"></div>
  <br>
  Test file: <input id="test" class="input" type="text" size="60" value="http://www.rezsoft.org/textglass/reference/domains/a/test.json"><br>
  <br>
  <div id="testout" class="out"></div>
  <br>
  Test input: <input id="input" class="input" type="text" size="80" value=""><br>
  <br>
  <div id="inputout" class="out"></div>
  <br>
  <input id="load" type="button" value="Load" onclick="load()"><br>
  <br>
  <div id="out" class="out"></div>
  
  <script>
    function get(id) {
      return document.getElementById(id);
    }

    get('input').value = navigator.userAgent;

    var textglass = textglass || {};

    textglass.debugLevel = 3;

    function load() {
      textglass.debug(3, 'Load button clicked');

      get('clientout').innerHTML = 'Loading...';
      get('testout').innerHTML = '';
      get('inputout').innerHTML = '';
      
      var button = get('load');

      button.disabled = true;

      var pattern = get('pattern').value;
      var attribute = get('attribute').value;
      var test = get('test').value;
      var input = get('input').value;

      textglass.loadURLs(pattern, attribute, undefined, undefined, function(state, msg, domain) {
        textglass.debug(3, 'textglass.loadURL() callback', state, msg, domain);

        get('clientout').innerHTML = state + (msg ? ': ' + msg : '');

        if(domain) {
          if(test) {
            textglasstest.loadURL(test, function(state, msg) {
              textglass.debug(3, 'textglasstest.loadURL() callback', state, msg);

              get('testout').innerHTML = state + (msg ? ': ' + msg : '');
              
              button.disabled = false;
            });
          }

          if(input) {
            var inputout = textglass.domains[domain].classify(input);

            textglass.debug(1, 'input result', inputout);

            get('inputout').innerHTML = JSON.stringify(inputout, null, 2);
          }
        }

        if(!test) {
          button.disabled = false;
        }
      });
    }

    function main() {
      if(textglass.loaded) {
        get('out').innerHTML = 'TextGlass Javascript Client ' + textglass.version + ' LOADED!';
      } else {
        get('out').innerHTML = 'TextGlass ERROR';
      }
    }
  </script>

  <script src="js/textglass.js"></script>
  <script src="js/textglasstest.js"></script>

</body>
</html>
